!function(){"use strict";function t(){}function e(t,e,i){i=new o(i).get(),this._httpMethod=new r(t).get(),this._url=new s(e).get(),this._parameters=new a(i).get(),this._rfc3986=new n}function r(t){this._httpMethod=t||""}function s(t){this._url=t||""}function a(t){this._parameters=t||{},this._sortedKeys=[],this._normalizedParameters=[],this._rfc3986=new n,this._sortParameters(),this._concatenateParameters()}function o(t){this._parameters={},this._loadParameters(t||{})}function n(){}function i(t,e,r){this._rfc3986=new n,this._text=t,this._key=this._rfc3986.encode(e)+"&"+this._rfc3986.encode(r),this._base64EncodedHash=new h(this._text,this._key).getBase64EncodedHash()}function h(t,e){this._cryptoJS=c?require("crypto-js"):CryptoJS,this._text=t||"",this._key=e||"",this._hash=this._cryptoJS.HmacSHA1(this._text,this._key)}var c="undefined"!=typeof module&&"undefined"!=typeof module.exports;t.prototype.generate=function(t,r,s,a,o,n){console.log("url is "+r);var h=new e(t,r,s).generate(),c=!0;return n&&(c=n.encodeSignature),new i(h,a,o).generate(c)},e.prototype={generate:function(){return this._rfc3986.encode(this._httpMethod)+"&"+this._rfc3986.encode(this._url)+"&"+this._rfc3986.encode(this._parameters)}},r.prototype={get:function(){return this._httpMethod.toUpperCase()}},s.prototype={get:function(){if(!this._url)return this._url;-1==this._url.indexOf("://")&&(this._url="http://"+this._url);var t=c?this.parseInNode():this.parseInBrowser(),e=(t.scheme||"http").toLowerCase(),r=(t.authority||"").toLocaleLowerCase(),s=t.path||"",a=t.port||"";(80==a&&"http"==e||443==a&&"https"==e)&&(a="");var o=e+"://"+r;return o+=a?":"+a:"","/"==s&&-1===this._url.indexOf(o+s)&&(s=""),this._url=(e?e+"://":"")+r+(a?":"+a:"")+s,this._url},parseInBrowser:function(){return{scheme:url("protocol",this._url).toLowerCase(),authority:url("hostname",this._url).toLocaleLowerCase(),port:url("port",this._url),path:url("path",this._url)}},parseInNode:function(){var t=require("uri-js"),e=t.parse(this._url),r=e.scheme;return":"==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),{scheme:r,authority:e.host,port:e.port,path:e.path}}},a.prototype={_sortParameters:function(){var t,e;for(t in this._parameters)this._parameters.hasOwnProperty(t)&&(e=this._rfc3986.encode(t),this._sortedKeys.push(e));this._sortedKeys.sort()},_concatenateParameters:function(){var t;for(t=0;t<this._sortedKeys.length;t++)this._normalizeParameter(this._sortedKeys[t])},_normalizeParameter:function(t){var e,r,s=this._rfc3986.decode(t),a=this._parameters[s];for(a.sort(),e=0;e<a.length;e++)r=this._rfc3986.encode(a[e]),this._normalizedParameters.push(t+"="+r)},get:function(){return this._normalizedParameters.join("&")}},o.prototype={_loadParameters:function(t){t instanceof Array?this._loadParametersFromArray(t):"object"==typeof t&&this._loadParametersFromObject(t)},_loadParametersFromArray:function(t){var e;for(e=0;e<t.length;e++)this._loadParametersFromObject(t[e])},_loadParametersFromObject:function(t){var e;for(e in t)t.hasOwnProperty(e)&&this._loadParameterValue(e,t[e]||"")},_loadParameterValue:function(t,e){var r;if(e instanceof Array){for(r=0;r<e.length;r++)this._addParameter(t,e[r]);0==e.length&&this._addParameter(t,"")}else this._addParameter(t,e)},_addParameter:function(t,e){this._parameters[t]||(this._parameters[t]=[]),this._parameters[t].push(e)},get:function(){return this._parameters}},n.prototype={encode:function(t){return t?encodeURIComponent(t).replace(/[!'()]/g,escape).replace(/\*/g,"%2A"):""},decode:function(t){return t?decodeURIComponent(t):""}},i.prototype={generate:function(t){return t===!1?this._base64EncodedHash:this._rfc3986.encode(this._base64EncodedHash)}},h.prototype={getBase64EncodedHash:function(){return this._hash.toString(this._cryptoJS.enc.Base64)}};var u=new t;u.SignatureBaseString=e,u.HttpMethodElement=r,u.UrlElement=s,u.ParametersElement=a,u.ParametersLoader=o,u.Rfc3986=n,u.HmacSha1Signature=i,u.HmacSha1=h,c?module.exports=u:window.oauthSignature=u}();